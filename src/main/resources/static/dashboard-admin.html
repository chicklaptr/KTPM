<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Admin Dashboard - Chung c∆∞ Bluemoon</title>
    <!-- Libraries for Excel and PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Chart.js for beautiful charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- Chart.js datalabels plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        background-attachment: fixed;
        min-height: 100vh;
      }
      .sidebar {
        width: 280px;
        height: 100vh;
        background: linear-gradient(180deg, #1e293b 0%, #0f172a 100%);
        color: white;
        position: fixed;
        padding-top: 30px;
        overflow-y: auto;
        box-shadow: 4px 0 20px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        transition: transform 0.3s ease;
      }
      .sidebar::-webkit-scrollbar {
        width: 6px;
      }
      .sidebar::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
      }
      .sidebar::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 3px;
      }
      .sidebar h2 {
        text-align: center;
        margin-bottom: 40px;
        font-size: 20px;
        font-weight: 700;
        letter-spacing: 1px;
        padding: 0 20px;
        color: #fff;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }
      .sidebar a {
        display: flex;
        align-items: center;
        padding: 16px 24px;
        color: rgba(255, 255, 255, 0.9);
        text-decoration: none;
        cursor: pointer;
        transition: all 0.3s ease;
        border-left: 3px solid transparent;
        font-weight: 500;
        font-size: 15px;
      }
      .sidebar a:hover {
        background: rgba(255, 255, 255, 0.1);
        border-left-color: #667eea;
        padding-left: 28px;
        color: #fff;
      }
      .sidebar a[style*="color: #e74c3c"] {
        color: #f87171 !important;
        margin-top: 30px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        padding-top: 20px;
      }
      .sidebar a[style*="color: #e74c3c"]:hover {
        background: rgba(239, 68, 68, 0.2);
        border-left-color: #ef4444;
      }
      .content {
        margin-left: 280px;
        padding: 30px;
        min-height: 100vh;
      }
      .section {
        display: none;
        animation: fadeIn 0.3s ease;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .active {
        display: block;
      }
      h2 {
        color: #1e293b;
        font-weight: 700;
        font-size: 28px;
        margin-bottom: 25px;
        display: flex;
        align-items: center;
        gap: 10px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        background: white;
        margin-top: 20px;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      }
      th,
      td {
        padding: 16px;
        border: none;
        text-align: left;
      }
      th {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        font-weight: 600;
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        position: sticky;
        top: 0;
        z-index: 10;
      }
      tbody tr {
        transition: all 0.2s ease;
        border-bottom: 1px solid #f1f5f9;
      }
      tbody tr:hover {
        background: #f8fafc;
        transform: scale(1.01);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      }
      tbody tr:last-child {
        border-bottom: none;
      }
      .btn {
        padding: 12px 24px;
        border: none;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        cursor: pointer;
        border-radius: 8px;
        margin: 4px;
        font-weight: 600;
        font-size: 14px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px -1px rgba(102, 126, 234, 0.3);
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }
      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 12px -1px rgba(102, 126, 234, 0.4);
      }
      .btn:active {
        transform: translateY(0);
      }
      .btn-danger {
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        box-shadow: 0 4px 6px -1px rgba(239, 68, 68, 0.3);
      }
      .btn-danger:hover {
        box-shadow: 0 6px 12px -1px rgba(239, 68, 68, 0.4);
      }
      .btn-success {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        box-shadow: 0 4px 6px -1px rgba(16, 185, 129, 0.3);
      }
      .btn-success:hover {
        box-shadow: 0 6px 12px -1px rgba(16, 185, 129, 0.4);
      }

      /* Modal styles */
      .modal {
        display: none;
        position: fixed;
        z-index: 2000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(4px);
        overflow-y: auto;
        animation: fadeIn 0.3s ease;
      }
      .modal-content {
        background-color: #ffffff;
        margin: 50px auto;
        padding: 40px;
        border: none;
        width: 90%;
        max-width: 700px;
        border-radius: 16px;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        position: relative;
        top: 50%;
        transform: translateY(-50%);
        max-height: 90vh;
        overflow-y: auto;
        animation: slideUp 0.3s ease;
      }
      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(-50%) translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(-50%) translateY(0);
        }
      }
      @media (max-height: 700px) {
        .modal-content {
          top: 0;
          transform: none;
          margin: 20px auto;
        }
      }
      .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
      }
      .close:hover {
        color: black;
      }
      .form-group {
        margin-bottom: 15px;
      }
      .form-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
      }
      .form-group input,
      .form-group select {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        box-sizing: border-box;
        font-size: 14px;
        transition: all 0.3s ease;
        background: #fff;
        font-family: 'Inter', sans-serif;
      }
      .form-group input:focus,
      .form-group select:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        transform: translateY(-1px);
      }
      .form-group input:hover,
      .form-group select:hover {
        border-color: #cbd5e1;
      }
      .form-group input[type="checkbox"] {
        width: auto;
        margin-right: 8px;
      }
      .form-group .error-message {
        color: #e74c3c;
        font-size: 12px;
        margin-top: 5px;
        display: none;
      }
      .form-group input.error,
      .form-group select.error {
        border-color: #e74c3c;
      }
      .search-box {
        margin-bottom: 20px;
      }
      .search-box input {
        padding: 12px 16px;
        width: 100%;
        max-width: 400px;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 14px;
        transition: all 0.3s ease;
        background: white;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
      }
      .search-box input:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }
      .search-box input::placeholder {
        color: #94a3b8;
      }
      
      /* Icon Buttons */
      .btn-icon {
        padding: 6px 10px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        min-width: 32px;
        height: 32px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .btn-icon:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
      }
      .btn-icon:active {
        transform: translateY(0);
      }
      .btn-view {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
      }
      .btn-view:hover {
        background: linear-gradient(135deg, #059669 0%, #047857 100%);
      }
      .btn-edit {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }
      .btn-edit:hover {
        background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
      }
      .btn-delete {
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        color: white;
      }
      .btn-delete:hover {
        background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
      }
      
      /* Responsive Design */
      @media (max-width: 768px) {
        .sidebar {
          transform: translateX(-100%);
          width: 260px;
        }
        .sidebar.active {
          transform: translateX(0);
        }
        .content {
          margin-left: 0;
          padding: 20px 15px;
        }
        h2 {
          font-size: 24px;
        }
        table {
          font-size: 14px;
        }
        th, td {
          padding: 10px 8px;
        }
        .btn {
          padding: 10px 16px;
          font-size: 13px;
        }
        .modal-content {
          width: 95%;
          padding: 25px;
          margin: 20px auto;
        }
      }
      
      @media (max-width: 480px) {
        .content {
          padding: 15px 10px;
        }
        h2 {
          font-size: 20px;
        }
        table {
          font-size: 12px;
        }
        th, td {
          padding: 8px 6px;
        }
        .search-box input {
          max-width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <div class="sidebar">
      <h2>QU·∫¢N L√ù CHUNG C∆Ø</h2>
      <a onclick="show('households')">üè† Xem t·∫•t c·∫£ h·ªô d√¢n</a>
      <a onclick="show('fee-categories')">üí∞ Qu·∫£n l√Ω lo·∫°i ph√≠</a>
      <a onclick="show('cost-stats')">üìä Th·ªëng k√™ chi ph√≠</a>
      <a onclick="show('billing')">üßæ Qu·∫£n l√Ω h√≥a ƒë∆°n th√°ng</a>
      <a onclick="show('accounts')">üë• Qu·∫£n l√Ω t√†i kho·∫£n c∆∞ d√¢n</a>
      <a onclick="show('reports')">üìë Xem b√°o c√°o</a>
      <a onclick="show('my-account')">üë§ Th√¥ng tin c√° nh√¢n</a>
      <a href="/login-admin.html" style="color: #e74c3c; margin-top: 20px"
        >üö™ ƒêƒÉng xu·∫•t</a
      >
    </div>

    <div class="content">
      <!-- H·ªô d√¢n -->
      <div id="households" class="section active">
        <h2>üè† Danh s√°ch h·ªô d√¢n</h2>
        <button class="btn btn-success" onclick="openHouseholdForm()">
          + Th√™m h·ªô d√¢n
        </button>
        <div class="search-box">
          <input
            type="text"
            id="searchHousehold"
            placeholder="T√¨m ki·∫øm theo t√™n, cƒÉn h·ªô, s·ªë ƒëi·ªán tho·∫°i..."
            onkeyup="filterHouseholds()"
          />
        </div>
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>M√£ h·ªô</th>
              <th>Ch·ªß h·ªô</th>
              <th>CƒÉn h·ªô</th>
              <th>S·ªë ƒëi·ªán tho·∫°i</th>
              <th>S·ªë th√†nh vi√™n</th>
              <th>Tr·∫°ng th√°i</th>
              <th>H√†nh ƒë·ªông</th>
            </tr>
          </thead>
          <tbody id="householdsTableBody">
            <tr>
              <td colspan="8" style="text-align: center">ƒêang t·∫£i...</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Lo·∫°i ph√≠ -->
      <div id="fee-categories" class="section">
        <h2>üí∞ Qu·∫£n l√Ω lo·∫°i ph√≠</h2>
        <button class="btn btn-success" onclick="openFeeCategoryForm()">
          + Th√™m lo·∫°i ph√≠ m·ªõi
        </button>
        <div class="search-box">
          <input
            type="text"
            id="searchFeeCategory"
            placeholder="T√¨m ki·∫øm theo m√£, t√™n lo·∫°i ph√≠..."
            onkeyup="filterFeeCategories()"
          />
        </div>
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>M√£ lo·∫°i ph√≠</th>
              <th>T√™n lo·∫°i ph√≠</th>
              <th>M√¥ t·∫£</th>
              <th>ƒê∆°n v·ªã</th>
              <th>S·ªë ti·ªÅn m·∫∑c ƒë·ªãnh</th>
              <th>C·ªë ƒë·ªãnh h√†ng th√°ng</th>
              <th>Tr·∫°ng th√°i</th>
              <th>H√†nh ƒë·ªông</th>
            </tr>
          </thead>
          <tbody id="feeCategoriesTableBody">
            <tr>
              <td colspan="9" style="text-align: center">ƒêang t·∫£i...</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Th·ªëng k√™ -->
      <div id="cost-stats" class="section">
        <h2>üìä Th·ªëng k√™ chi ph√≠ to√†n b·ªô t√≤a nh√†</h2>
        <div style="margin-bottom: 20px">
          <label>Ch·ªçn k·ª≥ thu ph√≠: </label>
          <select
            id="statsPeriodSelect"
            onchange="onPeriodSelectChange()"
            style="
              padding: 8px;
              margin-left: 10px;
              border: 1px solid #ddd;
              border-radius: 4px;
            "
          >
            <option value="">-- Ch·ªçn k·ª≥ thu ph√≠ --</option>
          </select>
          <button
            class="btn"
            onclick="refreshStatistics()"
            style="margin-left: 10px"
          >
            üîÑ T·∫£i l·∫°i
          </button>
        </div>
        <div id="costStatsContent">
          <p>Vui l√≤ng ch·ªçn k·ª≥ thu ph√≠ ƒë·ªÉ xem th·ªëng k√™</p>
        </div>
      </div>

      <!-- H√≥a ƒë∆°n -->
      <div id="billing" class="section">
        <h2>üßæ Qu·∫£n l√Ω h√≥a ƒë∆°n th√°ng</h2>
        <button class="btn btn-success" onclick="openBillingPeriodForm()">
          + T·∫°o k·ª≥ thu ph√≠ m·ªõi
        </button>
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>K·ª≥ thu ph√≠</th>
              <th>Ng√†y b·∫Øt ƒë·∫ßu</th>
              <th>Ng√†y k·∫øt th√∫c</th>
              <th>Tr·∫°ng th√°i</th>
              <th>H√†nh ƒë·ªông</th>
            </tr>
          </thead>
          <tbody id="billingPeriodsTableBody">
            <tr>
              <td colspan="6" style="text-align: center">ƒêang t·∫£i...</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- T√†i kho·∫£n -->
      <div id="accounts" class="section">
        <h2>üë• Qu·∫£n l√Ω t√†i kho·∫£n c∆∞ d√¢n</h2>
        <button class="btn btn-success" onclick="openAccountForm()">
          + T·∫°o t√†i kho·∫£n m·ªõi
        </button>
        <div style="margin: 15px 0; display: flex; gap: 10px; flex-wrap: wrap">
          <div class="search-box" style="flex: 1; min-width: 200px">
            <input
              type="text"
              id="searchAccount"
              placeholder="T√¨m ki·∫øm theo username, t√™n c∆∞ d√¢n..."
              onkeyup="filterAccounts()"
            />
          </div>
          <div style="display: flex; align-items: center; gap: 5px">
            <label>L·ªçc theo vai tr√≤:</label>
            <select
              id="filterAccountRole"
              onchange="filterAccounts()"
              style="padding: 8px; border: 1px solid #ddd; border-radius: 4px"
            >
              <option value="">T·∫•t c·∫£</option>
              <option value="1">RESIDENT</option>
              <option value="2">ADMIN</option>
            </select>
          </div>
        </div>
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Username</th>
              <th>Vai tr√≤</th>
              <th>C∆∞ d√¢n</th>
              <th>Ng√†y t·∫°o</th>
              <th>H√†nh ƒë·ªông</th>
            </tr>
          </thead>
          <tbody id="accountsTableBody">
            <tr>
              <td colspan="6" style="text-align: center">ƒêang t·∫£i...</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- B√°o c√°o -->
      <div id="reports" class="section">
        <h2>üìë Xem b√°o c√°o</h2>
        <div id="reportsContent">
          <p>ƒêang t·∫£i...</p>
        </div>
      </div>

      <!-- Th√¥ng tin t√†i kho·∫£n -->
      <div id="my-account" class="section">
        <h2>üë§ Th√¥ng tin t√†i kho·∫£n c·ªßa b·∫°n</h2>

        <div
          style="
            background: white;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            max-width: 600px;
          "
        >
          <div class="form-group">
            <label>T√™n ƒëƒÉng nh·∫≠p (Username):</label>
            <input
              type="text"
              id="myUsername"
              value=""
              readonly
              style="background-color: #f9f9f9; cursor: not-allowed"
            />
          </div>

          <div class="form-group">
            <label>Vai tr√≤ (Role):</label>
            <input
              type="text"
              id="myRole"
              value=""
              readonly
              style="background-color: #f9f9f9; cursor: not-allowed"
            />
          </div>

          <div
            class="form-group"
            id="myResidentInfoGroup"
            style="display: none"
          >
            <label>Th√¥ng tin c∆∞ d√¢n li√™n k·∫øt:</label>
            <input
              type="text"
              id="myResidentName"
              value=""
              readonly
              style="background-color: #f9f9f9"
            />
          </div>

          <div
            style="
              margin-top: 30px;
              border-top: 1px solid #eee;
              padding-top: 20px;
            "
          >
            <button class="btn btn-success" onclick="openChangePasswordModal()">
              üîë ƒê·ªïi m·∫≠t kh·∫©u
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal: Household Form -->
    <div id="householdModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeModal('householdModal')"
          >&times;</span
        >
        <h2 id="householdFormTitle">Th√™m h·ªô d√¢n m·ªõi</h2>
        <form id="householdForm" onsubmit="saveHousehold(event)">
          <div class="form-group">
            <label>M√£ h·ªô *</label>
            <input type="text" id="householdCode" required maxlength="50" />
            <div class="error-message"></div>
          </div>
          <div class="form-group">
            <label>T√™n ch·ªß h·ªô *</label>
            <input type="text" id="ownerName" required maxlength="100" />
            <div class="error-message"></div>
          </div>
          <div class="form-group">
            <label>S·ªë cƒÉn h·ªô *</label>
            <input type="text" id="apartmentNumber" required maxlength="20" />
            <div class="error-message"></div>
          </div>
          <div class="form-group">
            <label>S·ªë ƒëi·ªán tho·∫°i</label>
            <input
              type="text"
              id="phone"
              maxlength="20"
              placeholder="10-11 ch·ªØ s·ªë"
            />
            <div class="error-message"></div>
          </div>
          <div class="form-group">
            <label>S·ªë th√†nh vi√™n</label>
            <input type="number" id="membersCount" min="1" />
            <div class="error-message"></div>
          </div>
          <div class="form-group">
            <label>T√¨nh tr·∫°ng c∆∞ tr√∫</label>
            <select id="residenceStatus">
              <option value="">-- Ch·ªçn --</option>
              <option value="DANG_O">ƒêang ·ªü</option>
              <option value="DA_CHUYEN">ƒê√£ chuy·ªÉn</option>
              <option value="TAM_VANG">T·∫°m v·∫Øng</option>
            </select>
          </div>
          <div class="form-group">
            <label>Ng√†y v√†o ·ªü</label>
            <input type="date" id="moveInDate" />
          </div>
          <div class="form-group">
            <label>Ng√†y chuy·ªÉn ƒëi</label>
            <input type="date" id="moveOutDate" />
            <div class="error-message"></div>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" id="householdOwnsApartment" /> ƒê√£ mua cƒÉn
              h·ªô (kh√¥ng c·∫ßn ƒë√≥ng ph√≠ thu√™)
            </label>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" id="householdActive" checked /> Ho·∫°t ƒë·ªông
            </label>
          </div>

          <!-- Qu·∫£n l√Ω c∆∞ d√¢n (ch·ªâ hi·ªÉn th·ªã khi s·ª≠a) -->
          <div id="residentsSection" style="display: none; margin-top: 30px; padding-top: 20px; border-top: 2px solid #e2e8f0;">
            <h3 style="color: #1e293b; margin-bottom: 15px; font-size: 18px;">üë• Qu·∫£n l√Ω c∆∞ d√¢n trong h·ªô</h3>
            <button type="button" class="btn btn-success" onclick="addResidentRow()" style="margin-bottom: 15px;">
              + Th√™m c∆∞ d√¢n
            </button>
            <div id="residentsList" style="max-height: 400px; overflow-y: auto;">
              <!-- Danh s√°ch c∆∞ d√¢n s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
            </div>
          </div>

          <button type="submit" class="btn btn-success">L∆∞u</button>
          <button
            type="button"
            class="btn"
            onclick="closeModal('householdModal')"
          >
            H·ªßy
          </button>
        </form>
      </div>
    </div>

    <!-- Modal: Billing Period Form -->
    <div id="billingPeriodModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeModal('billingPeriodModal')"
          >&times;</span
        >
        <h2 id="billingPeriodFormTitle">T·∫°o k·ª≥ thu ph√≠ m·ªõi</h2>
        <form id="billingPeriodForm" onsubmit="saveBillingPeriod(event)">
          <div class="form-group">
            <label>NƒÉm *</label>
            <input
              type="number"
              id="periodYear"
              min="2000"
              max="2100"
              required
            />
            <div class="error-message"></div>
          </div>
          <div class="form-group">
            <label>Th√°ng *</label>
            <input type="number" id="periodMonth" min="1" max="12" required />
            <div class="error-message"></div>
          </div>
          <div class="form-group">
            <label>Ng√†y b·∫Øt ƒë·∫ßu *</label>
            <input type="date" id="periodStartDate" required />
            <div class="error-message"></div>
          </div>
          <div class="form-group">
            <label>Ng√†y k·∫øt th√∫c *</label>
            <input type="date" id="periodEndDate" required />
            <div class="error-message"></div>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" id="periodClosed" /> ƒê√£ ƒë√≥ng k·ª≥
            </label>
          </div>
          <button type="submit" class="btn btn-success">L∆∞u</button>
          <button
            type="button"
            class="btn"
            onclick="closeModal('billingPeriodModal')"
          >
            H·ªßy
          </button>
        </form>
      </div>
    </div>

    <!-- Modal: Period Details -->
    <div id="periodDetailsModal" class="modal">
      <div class="modal-content" style="max-width: 1200px">
        <span class="close" onclick="closeModal('periodDetailsModal')"
          >&times;</span
        >
        <h2 id="periodDetailsTitle">Chi ti·∫øt k·ª≥ thu ph√≠</h2>
        <div
          id="periodInfo"
          style="
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 4px;
          "
        >
          <strong>K·ª≥ thu ph√≠:</strong> <span id="periodInfoText"></span>
        </div>
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>M√£ h·ªô</th>
              <th>Ch·ªß h·ªô</th>
              <th>CƒÉn h·ªô</th>
              <th>Lo·∫°i ph√≠</th>
              <th>S·ªë l∆∞·ª£ng</th>
              <th>ƒê∆°n gi√°</th>
              <th>S·ªë ti·ªÅn</th>
              <th>Tr·∫°ng th√°i</th>
              <th>H·∫°n thanh to√°n</th>
            </tr>
          </thead>
          <tbody id="periodDetailsTableBody"></tbody>
        </table>
        <div
          style="
            margin-top: 15px;
            padding: 10px;
            background: #e8f5e9;
            border-radius: 4px;
          "
        >
          <strong>T·ªïng s·ªë h·ªô:</strong> <span id="totalHouseholds">0</span> |
          <strong>T·ªïng s·ªë ph√≠:</strong> <span id="totalFees">0</span> |
          <strong>T·ªïng ti·ªÅn:</strong> <span id="totalAmount">0ƒë</span>
        </div>
        <button
          class="btn"
          onclick="closeModal('periodDetailsModal')"
          style="margin-top: 15px"
        >
          ƒê√≥ng
        </button>
      </div>
    </div>

    <!-- Modal: Fee Category Form -->
    <div id="feeCategoryModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeModal('feeCategoryModal')"
          >&times;</span
        >
        <h2 id="feeCategoryFormTitle">Th√™m lo·∫°i ph√≠ m·ªõi</h2>
        <form id="feeCategoryForm" onsubmit="saveFeeCategory(event)">
          <div class="form-group">
            <label>M√£ lo·∫°i ph√≠ *</label>
            <input
              type="text"
              id="feeCategoryCode"
              required
              maxlength="50"
              placeholder="VD: DIEN, NUOC, PHI_QL"
            />
            <div class="error-message"></div>
          </div>
          <div class="form-group">
            <label>T√™n lo·∫°i ph√≠ *</label>
            <input
              type="text"
              id="feeCategoryName"
              required
              maxlength="100"
              placeholder="VD: ƒêi·ªán, N∆∞·ªõc, Ph√≠ qu·∫£n l√Ω"
            />
            <div class="error-message"></div>
          </div>
          <div class="form-group">
            <label>M√¥ t·∫£</label>
            <input
              type="text"
              id="feeCategoryDescription"
              maxlength="255"
              placeholder="M√¥ t·∫£ chi ti·∫øt v·ªÅ lo·∫°i ph√≠"
            />
          </div>
          <div class="form-group">
            <label>ƒê∆°n v·ªã</label>
            <input
              type="text"
              id="feeCategoryUnit"
              maxlength="50"
              placeholder="VD: kWh, m¬≥, th√°ng"
            />
          </div>
          <div class="form-group">
            <label>S·ªë ti·ªÅn m·∫∑c ƒë·ªãnh</label>
            <input
              type="number"
              id="feeCategoryDefaultAmount"
              min="0"
              step="0.01"
              placeholder="0.00"
            />
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" id="feeCategoryFixedMonthly" checked /> C·ªë
              ƒë·ªãnh h√†ng th√°ng
            </label>
          </div>
          <div class="form-group">
            <label>
              <input type="checkbox" id="feeCategoryActive" checked /> Ho·∫°t ƒë·ªông
            </label>
          </div>
          <button type="submit" class="btn btn-success">L∆∞u</button>
          <button
            type="button"
            class="btn"
            onclick="closeModal('feeCategoryModal')"
          >
            H·ªßy
          </button>
        </form>
      </div>
    </div>

    <!-- Modal: Account Form -->
    <div id="accountModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeModal('accountModal')">&times;</span>
        <h2 id="accountFormTitle">T·∫°o t√†i kho·∫£n m·ªõi</h2>
        <form id="accountForm" onsubmit="saveAccount(event)">
          <div class="form-group">
            <label>Username *</label>
            <input
              type="text"
              id="accountUsername"
              required
              maxlength="50"
              placeholder="Nh·∫≠p username"
            />
            <div class="error-message"></div>
          </div>
          <div class="form-group">
            <label>Password <span id="passwordRequired">*</span></label>
            <input
              type="password"
              id="accountPassword"
              minlength="6"
              placeholder="T·ªëi thi·ªÉu 6 k√Ω t·ª±"
            />
            <div class="error-message"></div>
          </div>
          <div class="form-group">
            <label>Vai tr√≤ *</label>
            <select id="accountRoleId" required>
              <option value="">-- Ch·ªçn vai tr√≤ --</option>
              <option value="1">RESIDENT</option>
              <option value="2">ADMIN</option>
            </select>
            <div class="error-message"></div>
          </div>
          <div class="form-group" id="residentFieldGroup">
            <label>C∆∞ d√¢n (d√†nh cho RESIDENT)</label>
            <select id="accountResidentId">
              <option value="">-- Ch·ªçn c∆∞ d√¢n (t√πy ch·ªçn) --</option>
            </select>
            <small style="color: #666; font-size: 12px"
              >Ch·ªâ ch·ªçn n·∫øu t√†i kho·∫£n RESIDENT d√†nh cho c∆∞ d√¢n c·ª• th·ªÉ. T√†i kho·∫£n
              ADMIN kh√¥ng c·∫ßn ch·ªçn.</small
            >
          </div>
          <button type="submit" class="btn btn-success">L∆∞u</button>
          <button
            type="button"
            class="btn"
            onclick="closeModal('accountModal')"
          >
            H·ªßy
          </button>
        </form>
      </div>
    </div>

    <!-- Modal: Account Details -->
    <div id="accountDetailsModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeModal('accountDetailsModal')"
          >&times;</span
        >
        <h2>Chi ti·∫øt t√†i kho·∫£n</h2>
        <table style="width: 100%; margin-top: 20px">
          <tr>
            <th style="width: 150px; text-align: left">ID</th>
            <td id="accountDetailsId"></td>
          </tr>
          <tr>
            <th>Username</th>
            <td id="accountDetailsUsername"></td>
          </tr>
          <tr>
            <th>Vai tr√≤</th>
            <td id="accountDetailsRole"></td>
          </tr>
          <tr>
            <th>C∆∞ d√¢n</th>
            <td id="accountDetailsResident"></td>
          </tr>
          <tr>
            <th>Ng√†y t·∫°o</th>
            <td id="accountDetailsCreated"></td>
          </tr>
          <tr>
            <th>Ng√†y c·∫≠p nh·∫≠t</th>
            <td id="accountDetailsUpdated"></td>
          </tr>
        </table>
        <button
          class="btn"
          onclick="closeModal('accountDetailsModal')"
          style="margin-top: 15px"
        >
          ƒê√≥ng
        </button>
      </div>
    </div>

    <div id="changePasswordModal" class="modal">
      <div class="modal-content" style="max-width: 500px">
        <span class="close" onclick="closeModal('changePasswordModal')"
          >&times;</span
        >
        <h2>ƒê·ªïi m·∫≠t kh·∫©u</h2>
        <form id="changePasswordForm" onsubmit="handleChangePassword(event)">
          <div class="form-group">
            <label>M·∫≠t kh·∫©u c≈© *</label>
            <input type="password" id="oldPassword" required minlength="6" />
          </div>
          <div class="form-group">
            <label>M·∫≠t kh·∫©u m·ªõi *</label>
            <input type="password" id="newPassword" required minlength="6" />
          </div>
          <div class="form-group">
            <label>Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi *</label>
            <input
              type="password"
              id="confirmNewPassword"
              required
              minlength="6"
            />
            <div class="error-message" id="passwordMatchError">
              M·∫≠t kh·∫©u kh√¥ng kh·ªõp
            </div>
          </div>
          <button type="submit" class="btn btn-success">C·∫≠p nh·∫≠t</button>
          <button
            type="button"
            class="btn"
            onclick="closeModal('changePasswordModal')"
          >
            H·ªßy
          </button>
        </form>
      </div>
    </div>

    <!-- Modal: Household Details -->
    <div id="householdDetailsModal" class="modal">
      <div class="modal-content" style="max-width: 900px;">
        <span class="close" onclick="closeModal('householdDetailsModal')"
          >&times;</span
        >
        <h2 id="householdDetailsTitle">Chi ti·∫øt h·ªô gia ƒë√¨nh</h2>
        <div id="householdDetailsContent">
          <div style="text-align: center; padding: 20px;">
            <div style="font-size: 48px; margin-bottom: 10px;">‚è≥</div>
            <p>ƒêang t·∫£i th√¥ng tin...</p>
          </div>
        </div>
      </div>
    </div>

    <script src="/money-utils.js"></script>
    <script src="/admin.js"></script>
  </body>
</html>
